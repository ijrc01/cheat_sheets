Domain Password Audit Tool (DPAT.py)
https://github.com/clr2of8/DPAT
Ex: dpat.py -n customer.ntds -c hashcat.potfile -g "Domain Admins.txt" "Enterprise Admins.txt"

This is a python script that will generate password use statistics from password hashes dumped from a domain controller and a password crack file such as hashcat.potfile generated from the Hashcat tool during password cracking. The report is an HTML report with clickable links.

Required parameters:
	-n hashes extracted from the domain controller
	-c the list of cracked passwords generated by tools like Hashcat or JohnTheRipper

Your customer.ntds file should be in this format:
	domain\username:RID:lmhash:nthash:::

1.	Dump the password hashes from your domain controller by executing the following command in an administrative command prompt on a domain controller.
a.	ntdsutil "ac in ntds" "ifm" "cr fu c:\temp" q q
2.	The ntdsutil command will create the two files, Active Directory\ntds.dit and registry\SYSTEM
3.	Pass these 2 files through secretdumps.py to extract the Windows domain user password hashes from the NTDS.dit file using the SYSTEM registry hive
a.	secretsdump.py -system registry/SYSTEM -ntds "Active Directory/ntds.dit" LOCAL -outputfile customer
4.	The output will be ‘customer.ntds’, which you pass through dpat.py



usage: dpat.py [-h] -n NTDSFILE -c CRACKFILE [-o OUTPUTFILE]
               [-d REPORTDIRECTORY] [-w] [-s]
               [-g [GROUPLISTS [GROUPLISTS ...]]]

This script will perfrom a domain password audit based on an extracted NTDS
file and password cracking output such as Hashcat.

optional arguments:
  -h, --help            Show this help message and exit
  -n NTDSFILE, --ntdsfile NTDSFILE
                        NTDS file name (output from SecretsDump.py)
  -c CRACKFILE, --crackfile CRACKFILE
                        Password Cracking output in the default form output by
                        Hashcat, such as hashcat.potfile
  -o OUTPUTFILE, --outputfile OUTPUTFILE
                        The name of the HTML report output file, defaults to
                        _DomainPasswordAuditReport.html
  -d REPORTDIRECTORY, --reportdirectory REPORTDIRECTORY
                        Folder containing the output HTML files, defaults to
                        DPAT Report
  -w, --writedb         Write the SQLite database info to disk for offline
                        inspection instead of just in memory. Filename will be
                        "pass_audit.db"
  -s, --sanitize        Sanitize the report by partially redacting passwords
                        and hashes. Appends the report directory with
                        " - Sanitized"
  -g [GROUPLISTS [GROUPLISTS ...]], --grouplists [GROUPLISTS [GROUPLISTS ...]]
                        The name of one or multiple files that contain lists
                        of usernames in particular groups. The group names
                        will be taken from the file name itself. The username
                        list must be in the same format as found in the NTDS
                        file such as some.ad.domain.com\username. Example: -g
                        "Domain Admins.txt" "Enterprise Admins.txt"





